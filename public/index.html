<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syst√®me de Gestion Scolaire</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .minotaur-avatar {
            display: inline-block;
            font-size: 3rem;
            animation: charge 2s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(255, 0, 0, 0.5));
        }
        @keyframes charge {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            50% { transform: translateX(-3px) rotate(-2deg); }
        }
        .kraken-avatar {
            display: inline-block;
            font-size: 3rem;
            animation: tentacles 3s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(0, 100, 255, 0.5));
        }
        @keyframes tentacles {
            0%, 100% { transform: rotate(0deg) scale(1); }
            33% { transform: rotate(2deg) scale(1.05); }
            66% { transform: rotate(-2deg) scale(0.95); }
        }
        .phoenix-avatar {
            display: inline-block;
            font-size: 3rem;
            animation: flames 2s ease-in-out infinite;
            filter: drop-shadow(0 0 15px rgba(255, 165, 0, 0.7));
        }
        @keyframes flames {
            0%, 100% { transform: translateY(0px) scale(1); }
            25% { transform: translateY(-2px) scale(1.1); }
            75% { transform: translateY(1px) scale(0.9); }
        }
        .werewolf-avatar {
            display: inline-block;
            font-size: 3rem;
            animation: glow 4s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(0, 255, 0, 0.4));
        }
        @keyframes glow {
            0%, 100% { filter: drop-shadow(0 0 10px rgba(0, 255, 0, 0.4)); }
            50% { filter: drop-shadow(0 0 20px rgba(0, 255, 0, 0.8)) brightness(1.2); }
        }
        .franchise-avatar:hover {
            transform: scale(1.2);
            transition: transform 0.3s ease;
            cursor: pointer;
        }
        .franchise-card {
            position: relative;
            overflow: hidden;
        }
        .franchise-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            animation: sparkle 10s linear infinite;
            pointer-events: none;
        }
        @keyframes sparkle {
            0% { transform: translate(0, 0) rotate(0deg); }
            100% { transform: translate(-20px, -20px) rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        const App = () => {
          const [currentView, setCurrentView] = useState('home');
          const [userType, setUserType] = useState(null);
          const [players, setPlayers] = useState([]);
          const [expandedDropdown, setExpandedDropdown] = useState(null);
          const [selectedPlayerHistory, setSelectedPlayerHistory] = useState(null);
          const [playerHistory, setPlayerHistory] = useState([]);
          const [loading, setLoading] = useState(false);
          const [password, setPassword] = useState('');
          const [loginError, setLoginError] = useState('');
          const [teacherName, setTeacherName] = useState('');
          const [selectedStudent, setSelectedStudent] = useState('');
          const [newStudentName, setNewStudentName] = useState('');
          const [newStudentFranchise, setNewStudentFranchise] = useState('Minotaurs');
          const [searchName, setSearchName] = useState('');
          const [foundPlayer, setFoundPlayer] = useState(null);
          const [searchHistory, setSearchHistory] = useState([]);

          const getBadge = (score) => {
            if (score >= 250) return { emoji: 'üêê', name: 'GOAT', color: 'text-purple-300', bgColor: 'from-purple-600 to-purple-800' };
            if (score >= 200) return { emoji: 'üèõÔ∏è', name: 'Hall of Fame', color: 'text-yellow-300', bgColor: 'from-yellow-500 to-yellow-700' };
            if (score >= 150) return { emoji: 'üî•', name: 'Superstar', color: 'text-orange-300', bgColor: 'from-orange-500 to-red-600' };
            if (score >= 100) return { emoji: 'üåü', name: 'All-Star', color: 'text-blue-300', bgColor: 'from-blue-500 to-blue-700' };
            if (score >= 75) return { emoji: 'üíé', name: 'Franchise Player', color: 'text-cyan-300', bgColor: 'from-cyan-500 to-blue-600' };
            if (score >= 50) return { emoji: '‚≠ê', name: 'Starting Five', color: 'text-green-300', bgColor: 'from-green-500 to-green-700' };
            if (score >= 25) return { emoji: 'üèÉ', name: 'Sixth Man', color: 'text-emerald-300', bgColor: 'from-emerald-500 to-green-600' };
            if (score >= 10) return { emoji: 'üèÄ', name: 'Rookie', color: 'text-amber-300', bgColor: 'from-amber-500 to-orange-500' };
            if (score >= 0) return { emoji: 'üë∂', name: 'Freshman', color: 'text-yellow-300', bgColor: 'from-yellow-400 to-amber-500' };
            if (score >= -25) return { emoji: 'üìâ', name: 'Plot', color: 'text-gray-400', bgColor: 'from-gray-500 to-gray-700' };
            if (score >= -50) return { emoji: 'ü™ë', name: 'Benchwarmer', color: 'text-red-400', bgColor: 'from-red-500 to-red-700' };
            return { emoji: 'üóëÔ∏è', name: 'Scrub', color: 'text-red-600', bgColor: 'from-red-700 to-red-900' };
          };

          const getFranchiseAvatar = (franchise) => {
            const avatars = {
              Minotaurs: { emoji: 'üêÇ', class: 'minotaur-avatar' },
              Krakens: { emoji: 'üêô', class: 'kraken-avatar' },
              Phoenix: { emoji: 'üî•', class: 'phoenix-avatar' },
              Werewolves: { emoji: 'üê∫', class: 'werewolf-avatar' }
            };
            return avatars[franchise] || { emoji: '‚ö°', class: 'franchise-avatar' };
          };

          const positiveActions = [
            { label: 'Hardworker', points: 6 },
            { label: 'Victoire le weekend', points: 4 },
            { label: 'Participation le weekend', points: 2 },
            { label: 'Entrainement/atelier facultatif', points: 4 },
            { label: 'Observation positive', points: 5 },
            { label: 'Bonus', points: 2 },
            { label: 'Bonus', points: 3 },
            { label: 'Bonus', points: 5 },
            { label: 'Bonus', points: 10 },
            { label: 'F√©licitations', points: 25 },
            { label: 'Compliments', points: 15 },
            { label: 'Encouragements', points: 10 }
          ];

          const negativeActions = [
            { label: 'Observation n√©gative', points: -5 },
            { label: 'Exclusion de cours', points: -8 },
            { label: 'Exclusion temporaire', points: -15 },
            { label: 'Travail non fait', points: -3 },
            { label: 'Retard/absence non justifi√©e', points: -3 },
            { label: 'Absence non justifi√©e au club', points: -3 },
            { label: 'P√©nalit√©', points: -2 },
            { label: 'P√©nalit√©', points: -3 },
            { label: 'P√©nalit√©', points: -5 }
          ];

          const franchiseColors = {
            Minotaurs: 'from-red-600 to-red-800',
            Krakens: 'from-blue-600 to-blue-800',
            Phoenix: 'from-orange-600 to-orange-800',
            Werewolves: 'from-green-600 to-green-800'
          };

          const verifyTeacher = () => {
            if (password === 'admin') {
              setUserType('teacher');
              setCurrentView('teacher-dashboard');
              setLoginError('');
            } else {
              setLoginError('Mot de passe incorrect');
            }
          };

          const loadPlayers = () => {
            const saved = localStorage.getItem('players');
            if (saved) setPlayers(JSON.parse(saved));
          };

          const savePlayers = (playersToSave) => {
            localStorage.setItem('players', JSON.stringify(playersToSave));
          };

          const addPoints = (playerName, points, action) => {
            const updated = players.map(p => 
              p.name === playerName ? {...p, score: p.score + points} : p
            );
            setPlayers(updated);
            savePlayers(updated);
            
            const historyKey = `history_${playerName}`;
            const history = JSON.parse(localStorage.getItem(historyKey) || '[]');
            history.unshift({
              action,
              points,
              timestamp: new Date().toLocaleString('fr-FR'),
              teacher_name: teacherName || 'Anonyme',
              new_total: updated.find(p => p.name === playerName).score
            });
            localStorage.setItem(historyKey, JSON.stringify(history.slice(0, 100)));
            setExpandedDropdown(null);
          };

          const loadPlayerHistory = (playerName) => {
            const historyKey = `history_${playerName}`;
            const history = JSON.parse(localStorage.getItem(historyKey) || '[]');
            setPlayerHistory(history);
            setSelectedPlayerHistory(playerName);
          };

          const undoLastAction = (playerName) => {
            const historyKey = `history_${playerName}`;
            const history = JSON.parse(localStorage.getItem(historyKey) || '[]');
            if (history.length > 0) {
              const lastAction = history[0];
              const updated = players.map(p => 
                p.name === playerName ? {...p, score: p.score - lastAction.points} : p
              );
              setPlayers(updated);
              savePlayers(updated);
              history.shift();
              localStorage.setItem(historyKey, JSON.stringify(history));
            }
          };

          const addStudent = () => {
            if (!newStudentName.trim()) {
              alert('Veuillez entrer un nom');
              return;
            }
            if (players.some(p => p.name === newStudentName.trim())) {
              alert('Cet √©l√®ve existe d√©j√†');
              return;
            }
            const updated = [...players, {
              name: newStudentName.trim(),
              franchise: newStudentFranchise,
              score: 0
            }];
            setPlayers(updated);
            savePlayers(updated);
            setNewStudentName('');
            alert('√âl√®ve ajout√© avec succ√®s !');
          };

          const removeStudent = (playerName) => {
            if (!confirm(`Supprimer ${playerName} ?`)) return;
            const updated = players.filter(p => p.name !== playerName);
            setPlayers(updated);
            savePlayers(updated);
            localStorage.removeItem(`history_${playerName}`);
            alert('√âl√®ve supprim√©');
          };

          const searchPlayer = () => {
            if (!searchName.trim()) {
              alert('Veuillez entrer votre nom');
              return;
            }
            const player = players.find(p => 
              p.name.toLowerCase() === searchName.trim().toLowerCase()
            );
            if (player) {
              setFoundPlayer(player);
              const history = JSON.parse(localStorage.getItem(`history_${player.name}`) || '[]');
              setSearchHistory(history);
            } else {
              setFoundPlayer(null);
              setSearchHistory([]);
              alert('√âl√®ve non trouv√©');
            }
          };

          useEffect(() => {
            const isFirstLoad = !localStorage.getItem('players');
            if (isFirstLoad) {
              const demoPlayers = [
                { name: 'Alice Martin', franchise: 'Minotaurs', score: 45 },
                { name: 'Bob Dupont', franchise: 'Minotaurs', score: 28 },
                { name: 'Charlie Durand', franchise: 'Krakens', score: 62 },
                { name: 'Diana Moreau', franchise: 'Krakens', score: 15 },
                { name: 'Eve Lambert', franchise: 'Phoenix', score: 89 },
                { name: 'Frank Bernard', franchise: 'Phoenix', score: -5 },
                { name: 'Grace Petit', franchise: 'Werewolves', score: 103 },
                { name: 'Henry Robert', franchise: 'Werewolves', score: 37 }
              ];
              savePlayers(demoPlayers);
              setPlayers(demoPlayers);
            }
            loadPlayers();
          }, []);

          useEffect(() => {
            if (userType) {
              const interval = setInterval(loadPlayers, 10000);
              return () => clearInterval(interval);
            }
          }, [userType]);

          const getSortedPlayers = (franchise) => {
            return players
              .filter(p => p.franchise === franchise)
              .sort((a, b) => b.score - a.score);
          };

          const getFranchiseRankings = () => {
            const scores = {};
            ['Minotaurs', 'Krakens', 'Phoenix', 'Werewolves'].forEach(f => {
              scores[f] = players
                .filter(p => p.franchise === f)
                .reduce((sum, p) => sum + p.score, 0);
            });
            return Object.entries(scores)
              .sort(([,a], [,b]) => b - a)
              .map(([franchise, score], i) => ({ franchise, score, rank: i + 1 }));
          };

          const getGeneralPlayerRankings = () => {
            return [...players].sort((a, b) => b.score - a.score);
          };

          if (currentView === 'home') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
                <div className="max-w-4xl mx-auto">
                  <h1 className="text-6xl font-bold text-center text-white mb-4">
                    üèÜ Syst√®me de Gestion Scolaire üèÜ
                  </h1>
                  <p className="text-xl text-center text-purple-200 mb-12">
                    Choisissez votre type d'acc√®s
                  </p>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <button
                      onClick={() => setCurrentView('teacher-login')}
                      className="group relative overflow-hidden bg-gradient-to-r from-emerald-600 to-emerald-800 hover:from-emerald-500 hover:to-emerald-700 text-white p-8 rounded-xl shadow-2xl transform hover:scale-105 transition-all duration-300"
                    >
                      <div className="relative z-10 flex flex-col items-center">
                        <div className="text-6xl mb-4">üë®‚Äçüè´</div>
                        <h2 className="text-3xl font-bold mb-2">PROFESSEUR</h2>
                        <p className="text-emerald-100">Gestion compl√®te</p>
                        <p className="text-sm text-emerald-200 mt-2">üîê Mot de passe requis</p>
                      </div>
                    </button>
                    <button
                      onClick={() => {
                        setUserType('student');
                        setCurrentView('student-dashboard');
                      }}
                      className="group relative overflow-hidden bg-gradient-to-r from-amber-600 to-amber-800 hover:from-amber-500 hover:to-amber-700 text-white p-8 rounded-xl shadow-2xl transform hover:scale-105 transition-all duration-300"
                    >
                      <div className="relative z-10 flex flex-col items-center">
                        <div className="text-6xl mb-4">üë®‚Äçüéì</div>
                        <h2 className="text-3xl font-bold mb-2">√âL√àVE</h2>
                        <p className="text-amber-100">Consultation des scores</p>
                        <p className="text-sm text-amber-200 mt-2">üëÅÔ∏è Lecture seule</p>
                      </div>
                    </button>
                  </div>
                </div>
              </div>
            );
          }

          if (currentView === 'teacher-login') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8 flex items-center justify-center">
                <div className="bg-white/10 backdrop-blur-sm rounded-xl p-8 max-w-md w-full">
                  <h2 className="text-3xl font-bold text-white text-center mb-8">
                    üîê Connexion Professeur
                  </h2>
                  <div className="space-y-6">
                    <div>
                      <label className="block text-white text-sm font-bold mb-2">Nom (optionnel)</label>
                      <input
                        type="text"
                        value={teacherName}
                        onChange={(e) => setTeacherName(e.target.value)}
                        className="w-full px-3 py-2 rounded-lg bg-white/20 text-white placeholder-white/70 border border-white/30"
                        placeholder="Votre nom..."
                      />
                    </div>
                    <div>
                      <label className="block text-white text-sm font-bold mb-2">Mot de passe *</label>
                      <input
                        type="password"
                        value={password}
                        onChange={(e) => setPassword(e.target.value)}
                        onKeyPress={(e) => e.key === 'Enter' && verifyTeacher()}
                        className="w-full px-3 py-2 rounded-lg bg-white/20 text-white placeholder-white/70 border border-white/30"
                        placeholder="Mot de passe..."
                      />
                    </div>
                    {loginError && (
                      <div className="text-red-300 text-sm text-center">{loginError}</div>
                    )}
                    <div className="flex space-x-4">
                      <button
                        onClick={() => setCurrentView('home')}
                        className="flex-1 bg-gray-600 hover:bg-gray-500 text-white py-3 rounded-lg transition-colors"
                      >
                        ‚Üê Retour
                      </button>
                      <button
                        onClick={verifyTeacher}
                        className="flex-1 bg-emerald-600 hover:bg-emerald-500 text-white py-3 rounded-lg transition-colors"
                      >
                        Se connecter
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          if (currentView === 'teacher-dashboard') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
                <div className="max-w-6xl mx-auto">
                  <div className="flex justify-between items-center mb-8">
                    <h1 className="text-4xl font-bold text-white">
                      üë®‚Äçüè´ Tableau de Bord Professeur
                      {teacherName && <span className="text-2xl text-purple-200"> - {teacherName}</span>}
                    </h1>
                    <button
                      onClick={() => {
                        setCurrentView('home');
                        setUserType(null);
                        setPassword('');
                      }}
                      className="bg-red-600 hover:bg-red-500 text-white px-6 py-3 rounded-lg"
                    >
                      üö™ D√©connexion
                    </button>
                  </div>
                  <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <button
                      onClick={() => setCurrentView('teacher-players')}
                      className="bg-gradient-to-r from-emerald-600 to-emerald-800 hover:from-emerald-500 hover:to-emerald-700 text-white p-6 rounded-xl shadow-2xl"
                    >
                      <div className="text-4xl mb-2">üë•</div>
                      <h3 className="text-xl font-bold">Gestion des Points</h3>
                      <p className="text-emerald-100 text-sm">Ajouter/retirer des points</p>
                    </button>
                    <button
                      onClick={() => setCurrentView('teacher-admin')}
                      className="bg-gradient-to-r from-blue-600 to-blue-800 hover:from-blue-500 hover:to-blue-700 text-white p-6 rounded-xl shadow-2xl"
                    >
                      <div className="text-4xl mb-2">‚öôÔ∏è</div>
                      <h3 className="text-xl font-bold">Administration</h3>
                      <p className="text-blue-100 text-sm">G√©rer les √©l√®ves</p>
                    </button>
                    <button
                      onClick={() => setCurrentView('rankings')}
                      className="bg-gradient-to-r from-amber-600 to-amber-800 hover:from-amber-500 hover:to-amber-700 text-white p-6 rounded-xl shadow-2xl"
                    >
                      <div className="text-4xl mb-2">üèÜ</div>
                      <h3 className="text-xl font-bold">Classements</h3>
                      <p className="text-amber-100 text-sm">Voir les r√©sultats</p>
                    </button>
                  </div>
                  <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                    <h3 className="text-2xl font-bold text-white mb-4">üìä Statistiques Rapides</h3>
                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                      {['Minotaurs', 'Krakens', 'Phoenix', 'Werewolves'].map(franchise => {
                        const franchisePlayers = getSortedPlayers(franchise);
                        const totalPoints = franchisePlayers.reduce((sum, p) => sum + p.score, 0);
                        const avatar = getFranchiseAvatar(franchise);
                        return (
                          <div key={franchise} className={`bg-gradient-to-r ${franchiseColors[franchise]} p-4 rounded-lg text-center franchise-card`}>
                            <div className="flex items-center justify-center mb-2">
                              <span className={`franchise-avatar ${avatar.class}`}>
                                {avatar.emoji}
                              </span>
                            </div>
                            <h4 className="font-bold text-white">{franchise}</h4>
                            <div className="text-2xl font-bold text-white">{totalPoints}</div>
                            <div className="text-sm text-white/80">{franchisePlayers.length} √©l√®ves</div>
                          </div>
                        );
                      })}
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          if (currentView === 'teacher-players') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
                <div className="max-w-7xl mx-auto">
                  <div className="flex justify-between items-center mb-8">
                    <h1 className="text-4xl font-bold text-white">üë• Gestion des Points</h1>
                    <button
                      onClick={() => setCurrentView('teacher-dashboard')}
                      className="bg-gray-600 hover:bg-gray-500 text-white px-6 py-3 rounded-lg"
                    >
                      ‚Üê Retour
                    </button>
                  </div>
                  <div className="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-6">
                    {['Minotaurs', 'Krakens', 'Phoenix', 'Werewolves'].map(franchise => {
                      const avatar = getFranchiseAvatar(franchise);
                      return (
                        <div key={franchise} className="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                          <h2 className={`text-2xl font-bold text-white mb-4 text-center bg-gradient-to-r ${franchiseColors[franchise]} p-3 rounded-lg`}>
                            <span className={`${avatar.class}`}>{avatar.emoji}</span> {franchise}
                          </h2>
                          <div className="space-y-3">
                            {getSortedPlayers(franchise).map(player => (
                              <div key={player.name} className="bg-white/20 rounded-lg p-3">
                                <div className="flex justify-between items-center mb-2">
                                  <button
                                    onClick={() => loadPlayerHistory(player.name)}
                                    className="text-white font-semibold hover:text-yellow-300"
                                  >
                                    {player.name} üìã
                                  </button>
                                  <div className="flex items-center space-x-2">
                                    <span className="text-2xl">{getBadge(player.score).emoji}</span>
                                    <span className="text-white font-bold">{player.score} pts</span>
                                    <button
                                      onClick={() => undoLastAction(player.name)}
                                      className="bg-red-500 hover:bg-red-400 text-white px-2 py-1 rounded text-xs"
                                    >
                                      ‚Ü∫
                                    </button>
                                  </div>
                                </div>
                                <div className="relative">
                                  <button
                                    onClick={() => setExpandedDropdown(expandedDropdown === player.name ? null : player.name)}
                                    className="w-full bg-blue-600 hover:bg-blue-500 text-white px-3 py-2 rounded"
                                  >
                                    Actions {expandedDropdown === player.name ? '‚åÉ' : '‚åÑ'}
                                  </button>
                                  {expandedDropdown === player.name && (
                                    <div className="absolute top-full left-0 right-0 bg-white rounded-lg shadow-xl z-10 mt-1 max-h-64 overflow-y-auto">
                                      <div className="p-2">
                                        <div className="text-green-700 font-semibold mb-2">Positifs:</div>
                                        {positiveActions.map((action, i) => (
                                          <button
                                            key={i}
                                            onClick={() => addPoints(player.name, action.points, action.label)}
                                            className="w-full text-left px-3 py-2 hover:bg-green-100 rounded text-sm flex justify-between"
                                          >
                                            <span>{action.label}</span>
                                            <span className="text-green-600 font-bold">+{action.points}</span>
                                          </button>
                                        ))}
                                        <div className="text-red-700 font-semibold mb-2 mt-3">N√©gatifs:</div>
                                        {negativeActions.map((action, i) => (
                                          <button
                                            key={i}
                                            onClick={() => addPoints(player.name, action.points, action.label)}
                                            className="w-full text-left px-3 py-2 hover:bg-red-100 rounded text-sm flex justify-between"
                                          >
                                            <span>{action.label}</span>
                                            <span className="text-red-600 font-bold">{action.points}</span>
                                          </button>
                                        ))}
                                      </div>
                                    </div>
                                  )}
                                </div>
                              </div>
                            ))}
                          </div>
                        </div>
                      );
                    })}
                  </div>
                </div>
              </div>
            );
          }

          if (currentView === 'teacher-admin') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
                <div className="max-w-6xl mx-auto">
                  <div className="flex justify-between items-center mb-8">
                    <h1 className="text-4xl font-bold text-white">‚öôÔ∏è Administration</h1>
                    <button
                      onClick={() => setCurrentView('teacher-dashboard')}
                      className="bg-gray-600 hover:bg-gray-500 text-white px-6 py-3 rounded-lg"
                    >
                      ‚Üê Retour
                    </button>
                  </div>
                  <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                      <h2 className="text-2xl font-bold text-white mb-6">‚ûï Ajouter un √âl√®ve</h2>
                      <div className="space-y-4">
                        <input
                          type="text"
                          value={newStudentName}
                          onChange={(e) => setNewStudentName(e.target.value)}
                          className="w-full px-3 py-2 rounded-lg bg-white/20 text-white"
                          placeholder="Nom de l'√©l√®ve..."
                        />
                        <select
                          value={newStudentFranchise}
                          onChange={(e) => setNewStudentFranchise(e.target.value)}
                          className="w-full px-3 py-2 rounded-lg bg-white/20 text-white"
                        >
                          <option value="Minotaurs" className="text-black">Minotaurs</option>
                          <option value="Krakens" className="text-black">Krakens</option>
                          <option value="Phoenix" className="text-black">Phoenix</option>
                          <option value="Werewolves" className="text-black">Werewolves</option>
                        </select>
                        <button
                          onClick={addStudent}
                          className="w-full bg-green-600 hover:bg-green-500 text-white py-3 rounded-lg"
                        >
                          ‚ûï Ajouter
                        </button>
                      </div>
                    </div>
                    <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                      <h2 className="text-2xl font-bold text-white mb-6">üóëÔ∏è Supprimer un √âl√®ve</h2>
                      <div className="space-y-4">
                        <select
                          value={selectedStudent}
                          onChange={(e) => setSelectedStudent(e.target.value)}
                          className="w-full px-3 py-2 rounded-lg bg-white/20 text-white"
                        >
                          <option value="" className="text-black">-- Choisir --</option>
                          {players.map(p => (
                            <option key={p.name} value={p.name} className="text-black">
                              {p.name} ({p.franchise})
                            </option>
                          ))}
                        </select>
                        <button
                          onClick={() => selectedStudent && removeStudent(selectedStudent)}
                          disabled={!selectedStudent}
                          className="w-full bg-red-600 hover:bg-red-500 disabled:bg-gray-500 text-white py-3 rounded-lg"
                        >
                          üóëÔ∏è Supprimer
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          if (currentView === 'student-dashboard') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
                <div className="max-w-4xl mx-auto">
                  <div className="flex justify-between items-center mb-8">
                    <h1 className="text-4xl font-bold text-white">üë®‚Äçüéì Espace √âl√®ve</h1>
                    <button
                      onClick={() => {
                        setCurrentView('home');
                        setUserType(null);
                      }}
                      className="bg-gray-600 hover:bg-gray-500 text-white px-6 py-3 rounded-lg"
                    >
                      ‚Üê Retour
                    </button>
                  </div>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <button
                      onClick={() => setCurrentView('student-search')}
                      className="bg-gradient-to-r from-blue-600 to-blue-800 hover:from-blue-500 hover:to-blue-700 text-white p-6 rounded-xl shadow-2xl"
                    >
                      <div className="text-4xl mb-2">üîç</div>
                      <h3 className="text-xl font-bold">Mon Score</h3>
                      <p className="text-blue-100 text-sm">Voir mon historique</p>
                    </button>
                    <button
                      onClick={() => setCurrentView('rankings')}
                      className="bg-gradient-to-r from-amber-600 to-amber-800 hover:from-amber-500 hover:to-amber-700 text-white p-6 rounded-xl shadow-2xl"
                    >
                      <div className="text-4xl mb-2">üèÜ</div>
                      <h3 className="text-xl font-bold">Classements</h3>
                      <p className="text-amber-100 text-sm">Voir tous les classements</p>
                    </button>
                  </div>
                </div>
              </div>
            );
          }

          if (currentView === 'student-search') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
                <div className="max-w-4xl mx-auto">
                  <div className="flex justify-between items-center mb-8">
                    <h1 className="text-4xl font-bold text-white">üîç Mon Score</h1>
                    <button
                      onClick={() => setCurrentView('student-dashboard')}
                      className="bg-gray-600 hover:bg-gray-500 text-white px-6 py-3 rounded-lg"
                    >
                      ‚Üê Retour
                    </button>
                  </div>
                  <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6 mb-8">
                    <div className="flex space-x-4">
                      <input
                        type="text"
                        value={searchName}
                        onChange={(e) => setSearchName(e.target.value)}
                        onKeyPress={(e) => e.key === 'Enter' && searchPlayer()}
                        className="flex-1 px-4 py-3 rounded-lg bg-white/20 text-white"
                        placeholder="Votre nom..."
                      />
                      <button
                        onClick={searchPlayer}
                        className="bg-blue-600 hover:bg-blue-500 text-white px-8 py-3 rounded-lg"
                      >
                        üîç Rechercher
                      </button>
                    </div>
                  </div>
                  {foundPlayer && (
                    <div className="space-y-6">
                      <div className={`bg-gradient-to-r ${franchiseColors[foundPlayer.franchise]} p-6 rounded-xl`}>
                        <div className="text-center">
                          <h2 className="text-3xl font-bold text-white mb-2">{foundPlayer.name}</h2>
                          <div className="text-xl text-white/90 mb-4">
                            Franchise: {getFranchiseAvatar(foundPlayer.franchise).emoji} {foundPlayer.franchise}
                          </div>
                          <div className="mb-4">
                            <span className="text-3xl">{getBadge(foundPlayer.score).emoji}</span>
                            <span className="text-xl font-bold text-white ml-2">
                              {getBadge(foundPlayer.score).name}
                            </span>
                          </div>
                          <div className="text-5xl font-bold text-white">{foundPlayer.score} points</div>
                        </div>
                      </div>
                      <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                        <h3 className="text-2xl font-bold text-white mb-6">üìã Historique</h3>
                        <div className="space-y-3 max-h-96 overflow-y-auto">
                          {searchHistory.map((entry, i) => (
                            <div key={i} className="bg-white/20 p-4 rounded-lg">
                              <div className="flex justify-between">
                                <div>
                                  <div className="font-semibold text-white">{entry.action}</div>
                                  <div className="text-sm text-white/80">{entry.timestamp}</div>
                                </div>
                                <div className="text-right">
                                  <div className={`text-lg font-bold ${entry.points > 0 ? 'text-green-300' : 'text-red-300'}`}>
                                    {entry.points > 0 ? '+' : ''}{entry.points}
                                  </div>
                                  <div className="text-sm text-white/70">Total: {entry.new_total}</div>
                                </div>
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    </div>
                  )}
                </div>
              </div>
            );
          }

          if (currentView === 'rankings') {
            const franchiseRankings = getFranchiseRankings();
            const playerRankings = getGeneralPlayerRankings();
            
            return (
              <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
                <div className="max-w-6xl mx-auto">
                  <div className="flex justify-between items-center mb-8">
                    <h1 className="text-4xl font-bold text-white">üèÜ Classements</h1>
                    <button
                      onClick={() => setCurrentView(userType === 'teacher' ? 'teacher-dashboard' : 'student-dashboard')}
                      className="bg-gray-600 hover:bg-gray-500 text-white px-6 py-3 rounded-lg"
                    >
                      ‚Üê Retour
                    </button>
                  </div>
                  <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                      <h2 className="text-2xl font-bold text-white mb-6 text-center">üèÜ Franchises</h2>
                      <div className="space-y-4">
                        {franchiseRankings.map(({ franchise, score, rank }) => {
                          const avatar = getFranchiseAvatar(franchise);
                          return (
                            <div key={franchise} className={`bg-gradient-to-r ${franchiseColors[franchise]} p-4 rounded-lg flex justify-between items-center`}>
                              <div className="flex items-center space-x-3">
                                <span className="text-2xl font-bold text-white">#{rank}</span>
                                <span className={`${avatar.class}`}>{avatar.emoji}</span>
                                <span className="text-xl font-semibold text-white">{franchise}</span>
                              </div>
                              <span className="text-2xl font-bold text-white">{score} pts</span>
                            </div>
                          );
                        })}
                      </div>
                    </div>
                    <div className="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                      <h2 className="text-2xl font-bold text-white mb-6 text-center">üëë G√©n√©ral</h2>
                      <div className="space-y-2 max-h-96 overflow-y-auto">
                        {playerRankings.map((player, i) => (
                          <div key={player.name} className={`bg-gradient-to-r ${franchiseColors[player.franchise]} p-3 rounded-lg flex justify-between items-center`}>
                            <div className="flex items-center space-x-3">
                              <span className="text-lg font-bold text-white">#{i + 1}</span>
                              <span className="text-2xl">{getBadge(player.score).emoji}</span>
                              <div>
                                <span className="text-lg font-semibold text-white">{player.name}</span>
                                <div className="text-sm text-white/80">{player.franchise}</div>
                              </div>
                            </div>
                            <span className="text-lg font-bold text-white">{player.score} pts</span>
                          </div>
                        ))}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          return (
            <>
              {selectedPlayerHistory && (
                <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
                  <div className="bg-white rounded-xl p-6 max-w-md w-full max-h-96 overflow-y-auto">
                    <div className="flex justify-between items-center mb-4">
                      <h3 className="text-xl font-bold">Historique de {selectedPlayerHistory}</h3>
                      <button
                        onClick={() => setSelectedPlayerHistory(null)}
                        className="text-gray-500 hover:text-gray-700 text-xl"
                      >
                        √ó
                      </button>
                    </div>
                    <div className="space-y-2">
                      {playerHistory.map((entry, i) => (
                        <div key={i} className="border-l-4 border-blue-500 pl-3 py-2">
                          <div className="font-semibold">{entry.action}</div>
                          <div className="text-sm text-gray-600">
                            {entry.points > 0 ? '+' : ''}{entry.points} points
                          </div>
                          <div className="text-xs text-gray-500">
                            {entry.timestamp} ‚Ä¢ Total: {entry.new_total} pts
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                </div>
              )}
            </>
          );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
