<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Système de Gestion Scolaire</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        /* === AVATARS ANIMÉS DES FRANCHISES === */

        /* Minotaurs - Taureau qui charge */
        .minotaur-avatar {
            display: inline-block;
            font-size: 3rem;
            animation: charge 2s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(255, 0, 0, 0.5));
        }

        @keyframes charge {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            50% { transform: translateX(-3px) rotate(-2deg); }
        }

        /* Krakens - Tentacules qui ondulent */
        .kraken-avatar {
            display: inline-block;
            font-size: 3rem;
            animation: tentacles 3s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(0, 100, 255, 0.5));
        }

        @keyframes tentacles {
            0%, 100% { transform: rotate(0deg) scale(1); }
            33% { transform: rotate(2deg) scale(1.05); }
            66% { transform: rotate(-2deg) scale(0.95); }
        }

        /* Phoenix - Flammes qui dansent */
        .phoenix-avatar {
            display: inline-block;
            font-size: 3rem;
            animation: flames 2s ease-in-out infinite;
            filter: drop-shadow(0 0 15px rgba(255, 165, 0, 0.7));
        }

        @keyframes flames {
            0%, 100% { transform: translateY(0px) scale(1); }
            25% { transform: translateY(-2px) scale(1.1); }
            75% { transform: translateY(1px) scale(0.9); }
        }

        /* Werewolves - Yeux qui brillent */
        .werewolf-avatar {
            display: inline-block;
            font-size: 3rem;
            animation: glow 4s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(0, 255, 0, 0.4));
        }

        @keyframes glow {
            0%, 100% { filter: drop-shadow(0 0 10px rgba(0, 255, 0, 0.4)); }
            50% { filter: drop-shadow(0 0 20px rgba(0, 255, 0, 0.8)) brightness(1.2); }
        }

        /* Effet de hover pour tous les avatars */
        .franchise-avatar:hover {
            transform: scale(1.2);
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        /* Particules de fond optionnelles */
        .franchise-card {
            position: relative;
            overflow: hidden;
        }

        .franchise-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            animation: sparkle 10s linear infinite;
            pointer-events: none;
        }

        @keyframes sparkle {
            0% { transform: translate(0, 0) rotate(0deg); }
            100% { transform: translate(-20px, -20px) rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        const App = () => {
          const [currentView, setCurrentView] = useState('home');
          const [userType, setUserType] = useState(null);
          const [players, setPlayers] = useState([]);
          const [expandedDropdown, setExpandedDropdown] = useState(null);
          const [selectedPlayerHistory, setSelectedPlayerHistory] = useState(null);
          const [playerHistory, setPlayerHistory] = useState([]);
          const [loading, setLoading] = useState(false);
          const [password, setPassword] = useState('');
          const [loginError, setLoginError] = useState('');
          const [teacherName, setTeacherName] = useState('');
          const [selectedStudent, setSelectedStudent] = useState('');
          const [newStudentName, setNewStudentName] = useState('');
          const [newStudentFranchise, setNewStudentFranchise] = useState('Minotaurs');
          const [searchName, setSearchName] = useState('');
          const [foundPlayer, setFoundPlayer] = useState(null);
          const [searchHistory, setSearchHistory] = useState([]);
          const [showEvolutionChart, setShowEvolutionChart] = useState(false);
          const [chartData, setChartData] = useState(null);
          const [chartType, setChartType] = useState('player');
          
          // === NOUVEAUX ÉTATS POUR LE SYSTÈME DE BADGES ===
          const [playerBadges, setPlayerBadges] = useState({}); // { playerName: [badgeId1, badgeId2...] }
          const [franchiseBadges, setFranchiseBadges] = useState({}); // { franchiseName: [badgeId1, badgeId2...] }
          const [badgeHistory, setBadgeHistory] = useState([]); // Historique des badges débloqués
          const [actionStreaks, setActionStreaks] = useState({}); // { playerName: { positive: 0, days: [] } }
          
          // === DÉFINITION DES BADGES INDIVIDUELS ===
          const individualBadges = {
            // SÉRIES
            hotStreak: {
              id: 'hotStreak',
              name: 'Hot Streak',
              emoji: '🔥',
              description: '5 actions positives d\'affilée',
              category: 'series',
              rarity: 'bronze',
              points: 5,
              condition: (player, history) => {
                // Vérifier 5 actions positives consécutives
                return false; // À implémenter
              }
            },
            tsunami: {
              id: 'tsunami',
              name: 'Tsunami',
              emoji: '🌊',
              description: '10 actions positives d\'affilée',
              category: 'series',
              rarity: 'silver',
              points: 10,
              condition: (player, history) => {
                // Vérifier 10 actions positives consécutives
                return false; // À implémenter
              }
            },
            unstoppable: {
              id: 'unstoppable',
              name: 'Unstoppable',
              emoji: '🚀',
              description: '15 actions positives d\'affilée',
              category: 'series',
              rarity: 'gold',
              points: 20,
              condition: (player, history) => {
                // Vérifier 15 actions positives consécutives
                return false; // À implémenter
              }
            },
            onFire: {
              id: 'onFire',
              name: 'On Fire',
              emoji: '🔥',
              description: '2 "Hardworker" (6pts) en 2 semaines',
              category: 'series',
              rarity: 'silver',
              points: 10,
              condition: (player, history) => {
                // Vérifier 2 Hardworker en 14 jours
                return false; // À implémenter
              }
            },
            
            // PERSÉVÉRANCE
            phoenix: {
              id: 'phoenix',
              name: 'Phoenix',
              emoji: '🦅',
              description: 'Remonter de -50 à +50 points',
              category: 'perseverance',
              rarity: 'gold',
              points: 20,
              condition: (player, history) => {
                // Vérifier remontée de -50 à +50
                return false; // À implémenter
              }
            },
            marathonRunner: {
              id: 'marathonRunner',
              name: 'Marathon Runner',
              emoji: '🏃',
              description: 'Actions positives 5 jours d\'école consécutifs',
              category: 'perseverance',
              rarity: 'bronze',
              points: 5,
              condition: (player, history) => {
                // Vérifier 5 jours consécutifs
                return false; // À implémenter
              }
            },
            
            // SOCIAUX/ÉQUIPE
            teamCaptain: {
              id: 'teamCaptain',
              name: 'Team Captain',
              emoji: '👑',
              description: 'Meilleur de sa franchise pendant 1 semaine',
              category: 'team',
              rarity: 'silver',
              points: 10,
              condition: (player, franchisePlayers) => {
                // Vérifier si meilleur de franchise
                return false; // À implémenter
              }
            },
            veteran: {
              id: 'veteran',
              name: 'Veteran',
              emoji: '🎖️',
              description: 'Top 3 de sa franchise pendant 2 mois',
              category: 'team',
              rarity: 'gold',
              points: 20,
              condition: (player, franchisePlayers) => {
                // Vérifier top 3 pendant 2 mois
                return false; // À implémenter
              }
            },
            teamPlayer: {
              id: 'teamPlayer',
              name: 'Team Player',
              emoji: '🤝',
              description: 'Sa franchise gagne le + de points en 1 semaine',
              category: 'team',
              rarity: 'bronze',
              points: 5,
              condition: (player, franchise) => {
                // Vérifier si franchise #1 de la semaine
                return false; // À implémenter
              }
            },
            
            // SPÉCIAUX & RARES
            showtime: {
              id: 'showtime',
              name: 'Showtime',
              emoji: '🎪',
              description: 'Recevoir "Félicitations" (25pts) 3 fois',
              category: 'special',
              rarity: 'diamond',
              points: 35,
              condition: (player, history) => {
                // Compter les Félicitations
                return false; // À implémenter
              }
            },
            halloweenSpirit: {
              id: 'halloweenSpirit',
              name: 'Halloween Spirit',
              emoji: '🎃',
              description: 'Actions positives semaine Halloween',
              category: 'special',
              rarity: 'legendary',
              points: 50,
              seasonal: true,
              condition: (player, history) => {
                // Vérifier actions pendant Halloween
                return false; // À implémenter
              }
            },
            christmasMagic: {
              id: 'christmasMagic',
              name: 'Christmas Magic',
              emoji: '🎄',
              description: 'Actions positives pendant les fêtes',
              category: 'special',
              rarity: 'legendary',
              points: 50,
              seasonal: true,
              condition: (player, history) => {
                // Vérifier actions pendant Noël
                return false; // À implémenter
              }
            },
            backToSchool: {
              id: 'backToSchool',
              name: 'Back to School',
              emoji: '📚',
              description: '10 actions positives premier mois rentrée',
              category: 'special',
              rarity: 'legendary',
              points: 50,
              seasonal: true,
              condition: (player, history) => {
                // Vérifier actions premier mois
                return false; // À implémenter
              }
            }
          };
          
          // === DÉFINITION DES BADGES COLLECTIFS ===
          const collectiveBadges = {
            // DOMINATION COLLECTIVE
            franchiseRoyalty: {
              id: 'franchiseRoyalty',
              name: 'Franchise Royalty',
              emoji: '👑',
              description: '#1 pendant 1 mois complet',
              category: 'domination',
              rarity: 'silver',
              franchisePoints: 50
            },
            dynasty: {
              id: 'dynasty',
              name: 'Dynasty',
              emoji: '🌟',
              description: '#1 pendant 3 mois consécutifs',
              category: 'domination',
              rarity: 'gold',
              franchisePoints: 100
            },
            empire: {
              id: 'empire',
              name: 'Empire',
              emoji: '🏛️',
              description: '#1 pendant 6 mois dans l\'année',
              category: 'domination',
              rarity: 'diamond',
              franchisePoints: 200
            },
            legendaryHouse: {
              id: 'legendaryHouse',
              name: 'Legendary House',
              emoji: '🐐',
              description: '#1 à la fin de l\'année scolaire',
              category: 'domination',
              rarity: 'legendary',
              franchisePoints: 500
            },
            
            // PERFORMANCES
            rocketLaunch: {
              id: 'rocketLaunch',
              name: 'Rocket Launch',
              emoji: '🚀',
              description: '+80 points collectifs en 1 semaine',
              category: 'performance',
              rarity: 'bronze',
              franchisePoints: 20
            },
            tidalWave: {
              id: 'tidalWave',
              name: 'Tidal Wave',
              emoji: '🌊',
              description: '+200 points collectifs en 1 mois',
              category: 'performance',
              rarity: 'gold',
              franchisePoints: 100
            },
            lightningStrike: {
              id: 'lightningStrike',
              name: 'Lightning Strike',
              emoji: '⚡',
              description: 'Tous les membres gagnent points même jour',
              category: 'performance',
              rarity: 'bronze',
              franchisePoints: 20
            },
            houseOnFire: {
              id: 'houseOnFire',
              name: 'House on Fire',
              emoji: '🔥',
              description: '80% membres actions positives en 1 semaine',
              category: 'performance',
              rarity: 'silver',
              franchisePoints: 50
            },
            
            // SOLIDARITÉ & ENTRAIDE
            unitedWeStand: {
              id: 'unitedWeStand',
              name: 'United We Stand',
              emoji: '🤝',
              description: 'Aucun membre négatif pendant 2 semaines',
              category: 'solidarity',
              rarity: 'silver',
              franchisePoints: 50
            },
            brotherhood: {
              id: 'brotherhood',
              name: 'Brotherhood/Sisterhood',
              emoji: '🛡️',
              description: 'Aider membre à sortir du négatif',
              category: 'solidarity',
              rarity: 'gold',
              franchisePoints: 100
            },
            perfectBalance: {
              id: 'perfectBalance',
              name: 'Perfect Balance',
              emoji: '⚖️',
              description: 'Tous membres entre 25-75 points',
              category: 'solidarity',
              rarity: 'gold',
              franchisePoints: 100
            },
            harmony: {
              id: 'harmony',
              name: 'Harmony',
              emoji: '🌈',
              description: 'Écart <50 points entre 1er et dernier',
              category: 'solidarity',
              rarity: 'silver',
              franchisePoints: 50
            },
            
            // OBJECTIFS COMMUNS
            showstoppers: {
              id: 'showstoppers',
              name: 'Showstoppers',
              emoji: '🎪',
              description: '3 membres "Félicitations" même trimestre',
              category: 'objectives',
              rarity: 'diamond',
              franchisePoints: 200
            },
            gemCollection: {
              id: 'gemCollection',
              name: 'Gem Collection',
              emoji: '💎',
              description: 'Tous atteignent au moins "Starting Five"',
              category: 'objectives',
              rarity: 'gold',
              franchisePoints: 100
            },
            fullSquad: {
              id: 'fullSquad',
              name: 'Full Squad',
              emoji: '👥',
              description: '100% participation activités optionnelles',
              category: 'objectives',
              rarity: 'silver',
              franchisePoints: 50
            },
            honorGuard: {
              id: 'honorGuard',
              name: 'Honor Guard',
              emoji: '🎖️',
              description: 'Aucune action négative pendant 1 mois',
              category: 'objectives',
              rarity: 'gold',
              franchisePoints: 100
            },
            
            // ÉVÉNEMENTS & SAISONS
            autumnChampions: {
              id: 'autumnChampions',
              name: 'Autumn Champions',
              emoji: '🍂',
              description: 'Meilleure franchise septembre-octobre',
              category: 'seasonal',
              rarity: 'legendary',
              franchisePoints: 200,
              seasonal: true
            },
            winterWarriors: {
              id: 'winterWarriors',
              name: 'Winter Warriors',
              emoji: '❄️',
              description: 'Meilleure franchise décembre-janvier',
              category: 'seasonal',
              rarity: 'legendary',
              franchisePoints: 200,
              seasonal: true
            },
            springAwakening: {
              id: 'springAwakening',
              name: 'Spring Awakening',
              emoji: '🌸',
              description: 'Meilleure franchise mars-avril',
              category: 'seasonal',
              rarity: 'legendary',
              franchisePoints: 200,
              seasonal: true
            }
          };
          
          // === FONCTIONS UTILITAIRES POUR LES BADGES ===
          
          // Obtenir la couleur selon la rareté
          const getRarityColor = (rarity) => {
            switch(rarity) {
              case 'bronze': return 'from-amber-600 to-amber-800 border-amber-400';
              case 'silver': return 'from-gray-400 to-gray-600 border-gray-300';
              case 'gold': return 'from-yellow-400 to-yellow-600 border-yellow-300';
              case 'diamond': return 'from-cyan-400 to-blue-600 border-cyan-300';
              case 'legendary': return 'from-purple-400 via-pink-500 to-red-500 border-purple-300';
              default: return 'from-gray-600 to-gray-800 border-gray-400';
            }
          };
          
          // Obtenir le texte de rareté
          const getRarityText = (rarity) => {
            switch(rarity) {
              case 'bronze': return '🥉 Bronze';
              case 'silver': return '🥈 Argent';
              case 'gold': return '🥇 Or';
              case 'diamond': return '💎 Diamant';
              case 'legendary': return '🌟 Légendaire';
              default: return '⭐ Commun';
            }
          };
          
          // Charger les badges depuis localStorage
          const loadBadges = () => {
            try {
              const savedPlayerBadges = localStorage.getItem('playerBadges');
              const savedFranchiseBadges = localStorage.getItem('franchiseBadges');
              const savedBadgeHistory = localStorage.getItem('badgeHistory');
              const savedActionStreaks = localStorage.getItem('actionStreaks');
              
              if (savedPlayerBadges) setPlayerBadges(JSON.parse(savedPlayerBadges));
              if (savedFranchiseBadges) setFranchiseBadges(JSON.parse(savedFranchiseBadges));
              if (savedBadgeHistory) setBadgeHistory(JSON.parse(savedBadgeHistory));
              if (savedActionStreaks) setActionStreaks(JSON.parse(savedActionStreaks));
            } catch (error) {
              console.error('Erreur lors du chargement des badges:', error);
            }
          };
          
          // Sauvegarder les joueurs dans localStorage
          const savePlayers = (playersToSave) => {
            try {
              localStorage.setItem('players', JSON.stringify(playersToSave));
            } catch (error) {
              console.error('Erreur lors de la sauvegarde des joueurs:', error);
            }
          };

          // Ajouter des points (professeurs uniquement)
          const addPoints = async (playerName, points, action) => {
            setLoading(true);
            try {
              // Mise à jour locale
              const updatedPlayers = players.map(player => {
                if (player.name === playerName) {
                  return { ...player, score: player.score + points };
                }
                return player;
              });
              
              setPlayers(updatedPlayers);
              savePlayers(updatedPlayers);
              
              // Sauvegarder dans l'historique
              const historyKey = `history_${playerName}`;
              const existingHistory = JSON.parse(localStorage.getItem(historyKey) || '[]');
              const newEntry = {
                action,
                points,
                timestamp: new Date().toLocaleString('fr-FR'),
                teacher_name: teacherName || 'Anonyme',
                new_total: updatedPlayers.find(p => p.name === playerName).score
              };
              existingHistory.unshift(newEntry);
              localStorage.setItem(historyKey, JSON.stringify(existingHistory.slice(0, 100)));
              
              setExpandedDropdown(null);
            } catch (error) {
              console.error('Erreur lors de l\'ajout de points:', error);
            }
            setLoading(false);
          };

          // Charger l'historique d'un joueur
          const loadPlayerHistory = async (playerName) => {
            try {
              const historyKey = `history_${playerName}`;
              const history = JSON.parse(localStorage.getItem(historyKey) || '[]');
              setPlayerHistory(history);
              setSelectedPlayerHistory(playerName);
            } catch (error) {
              console.error('Erreur lors du chargement de l\'historique:', error);
            }
          };

          // Annuler la dernière action (professeurs uniquement)
          const undoLastAction = async (playerName) => {
            setLoading(true);
            try {
              const historyKey = `history_${playerName}`;
              const history = JSON.parse(localStorage.getItem(historyKey) || '[]');
              
              if (history.length > 0) {
                const lastAction = history[0];
                
                // Retirer les points
                const updatedPlayers = players.map(player => {
                  if (player.name === playerName) {
                    return { ...player, score: player.score - lastAction.points };
                  }
                  return player;
                });
                
                setPlayers(updatedPlayers);
                savePlayers(updatedPlayers);
                
                // Supprimer de l'historique
                history.shift();
                localStorage.setItem(historyKey, JSON.stringify(history));
              }
            } catch (error) {
              console.error('Erreur lors de l\'annulation:', error);
            }
            setLoading(false);
          };

          // Ajouter un élève (professeurs uniquement)
          const addStudent = async () => {
            if (!newStudentName.trim()) {
              alert('Veuillez entrer un nom');
              return;
            }
            
            try {
              // Vérifier si l'élève existe déjà
              if (players.some(p => p.name === newStudentName.trim())) {
                alert('Un élève avec ce nom existe déjà');
                return;
              }
              
              const newPlayer = {
                name: newStudentName.trim(),
                franchise: newStudentFranchise,
                score: 0
              };
              
              const updatedPlayers = [...players, newPlayer];
              setPlayers(updatedPlayers);
              savePlayers(updatedPlayers);
              
              setNewStudentName('');
              alert('Élève ajouté avec succès !');
            } catch (error) {
              alert('Erreur lors de l\'ajout de l\'élève');
            }
          };

          // Supprimer un élève (professeurs uniquement)
          const removeStudent = async (playerName) => {
            if (!confirm(`Êtes-vous sûr de vouloir supprimer ${playerName} ? Cette action est irréversible.`)) {
              return;
            }
            
            try {
              const updatedPlayers = players.filter(p => p.name !== playerName);
              setPlayers(updatedPlayers);
              savePlayers(updatedPlayers);
              
              // Supprimer aussi l'historique et les badges
              localStorage.removeItem(`history_${playerName}`);
              
              // Retirer les badges du joueur
              const updatedPlayerBadges = { ...playerBadges };
              delete updatedPlayerBadges[playerName];
              setPlayerBadges(updatedPlayerBadges);
              localStorage.setItem('playerBadges', JSON.stringify(updatedPlayerBadges));
              
              alert('Élève supprimé avec succès');
            } catch (error) {
              alert('Erreur lors de la suppression');
            }
          };

          // === USEEFFECTS ===
          
          // Charger les données au démarrage
          useEffect(() => {
            loadPlayers();
            loadBadges();
          }, []);
          
          // Sauvegarder les badges quand ils changent
          useEffect(() => {
            if (Object.keys(playerBadges).length > 0 || Object.keys(franchiseBadges).length > 0) {
              saveBadges();
            }
          }, [playerBadges, franchiseBadges, badgeHistory, actionStreaks]);

          // Recharger les joueurs régulièrement si connecté
          useEffect(() => {
            if (userType) {
              loadPlayers();
              const interval = setInterval(loadPlayers, 10000);
              return () => clearInterval(interval);
            }
          }, [userType]);

          // Obtenir les joueurs triés par score pour une franchise
          const getSortedPlayers = (franchise) => {
            return players
              .filter(player => player.franchise === franchise)
              .sort((a, b) => b.score - a.score);
          };

          // Obtenir le classement des franchises
          const getFranchiseRankings = () => {
            const franchiseScores = {};
            ['Minotaurs', 'Krakens', 'Phoenix', 'Werewolves'].forEach(franchise => {
              franchiseScores[franchise] = players
                .filter(player => player.franchise === franchise)
                .reduce((total, player) => total + player.score, 0);
            });
            
            return Object.entries(franchiseScores)
              .sort(([,a], [,b]) => b - a)
              .map(([franchise, score], index) => ({ franchise, score, rank: index + 1 }));
          };

          // Obtenir le classement général des joueurs
          const getGeneralPlayerRankings = () => {
            return [...players].sort((a, b) => b.score - a.score);
          };

          // Rechercher un joueur par nom
          const searchPlayer = async () => {
            if (!searchName.trim()) {
              alert('Veuillez entrer votre nom');
              return;
            }

            const player = players.find(p => 
              p.name.toLowerCase() === searchName.trim().toLowerCase()
            );
            
            if (player) {
              setFoundPlayer(player);
              
              const historyKey = `history_${player.name}`;
              const history = JSON.parse(localStorage.getItem(historyKey) || '[]');
              setSearchHistory(history);
            } else {
              setFoundPlayer(null);
              setSearchHistory([]);
              alert('Élève non trouvé. Vérifiez l\'orthographe de votre nom.');
            }
          }; badges dans localStorage
          const saveBadges = () => {
            try {
              localStorage.setItem('playerBadges', JSON.stringify(playerBadges));
              localStorage.setItem('franchiseBadges', JSON.stringify(franchiseBadges));
              localStorage.setItem('badgeHistory', JSON.stringify(badgeHistory));
              localStorage.setItem('actionStreaks', JSON.stringify(actionStreaks));
            } catch (error) {
              console.error('Erreur lors de la sauvegarde des badges:', error);
            }
          };
          
          // Obtenir les badges d'un joueur
          const getPlayerBadges = (playerName) => {
            return playerBadges[playerName] || [];
          };
          
          // Obtenir les badges d'une franchise
          const getFranchiseBadges = (franchiseName) => {
            return franchiseBadges[franchiseName] || [];
          };
          
          // Fonction pour obtenir le grade basketball selon le score
          const getBadge = (score) => {
            // Grade Ultime
            if (score >= 250) return { 
              emoji: '🐐', 
              name: 'GOAT', 
              fullName: 'Greatest Of All Time',
              color: 'text-purple-300',
              bgColor: 'from-purple-600 to-purple-800',
              description: 'Le plus grand de tous les temps'
            };
            
            // Grades Elite
            if (score >= 200) return { 
              emoji: '🏛️', 
              name: 'Hall of Fame', 
              fullName: 'Hall of Fame',
              color: 'text-yellow-300',
              bgColor: 'from-yellow-500 to-yellow-700',
              description: 'Légende du sport'
            };
            if (score >= 150) return { 
              emoji: '🔥', 
              name: 'Superstar', 
              fullName: 'Superstar',
              color: 'text-orange-300',
              bgColor: 'from-orange-500 to-red-600',
              description: 'Phénomène basketball'
            };
            
            // Grades Confirmés
            if (score >= 100) return { 
              emoji: '🌟', 
              name: 'All-Star', 
              fullName: 'All-Star',
              color: 'text-blue-300',
              bgColor: 'from-blue-500 to-blue-700',
              description: 'Sélectionné parmi l\'élite'
            };
            if (score >= 75) return { 
              emoji: '💎', 
              name: 'Franchise Player', 
              fullName: 'Franchise Player',
              color: 'text-cyan-300',
              bgColor: 'from-cyan-500 to-blue-600',
              description: 'Pilier de l\'équipe'
            };
            
            // Grades Développement
            if (score >= 50) return { 
              emoji: '⭐', 
              name: 'Starting Five', 
              fullName: 'Starting Five',
              color: 'text-green-300',
              bgColor: 'from-green-500 to-green-700',
              description: 'Titulaire indiscutable'
            };
            if (score >= 25) return { 
              emoji: '🏃', 
              name: 'Sixth Man', 
              fullName: 'Sixth Man',
              color: 'text-emerald-300',
              bgColor: 'from-emerald-500 to-green-600',
              description: 'Premier remplaçant de qualité'
            };
            
            // Grades Débutants
            if (score >= 10) return { 
              emoji: '🏀', 
              name: 'Rookie', 
              fullName: 'Rookie',
              color: 'text-amber-300',
              bgColor: 'from-amber-500 to-orange-500',
              description: 'Débutant prometteur'
            };
            if (score >= 0) return { 
              emoji: '👶', 
              name: 'Freshman', 
              fullName: 'Freshman',
              color: 'text-yellow-300',
              bgColor: 'from-yellow-400 to-amber-500',
              description: 'Première année, apprend les bases'
            };
            
            // Grades Négatifs
            if (score >= -25) return { 
              emoji: '📉', 
              name: 'Plot', 
              fullName: 'Plot',
              color: 'text-gray-400',
              bgColor: 'from-gray-500 to-gray-700',
              description: 'Personnage sans importance'
            };
            if (score >= -50) return { 
              emoji: '🪑', 
              name: 'Benchwarmer', 
              fullName: 'Benchwarmer',
              color: 'text-red-400',
              bgColor: 'from-red-500 to-red-700',
              description: 'Cloué sur le banc'
            };
            
            // Pire niveau
            return { 
              emoji: '🗑️', 
              name: 'Scrub', 
              fullName: 'Scrub',
              color: 'text-red-600',
              bgColor: 'from-red-700 to-red-900',
              description: 'Le pire niveau possible'
            };
          };

          // Fonction pour obtenir l'avatar animé de la franchise
          const getFranchiseAvatar = (franchise) => {
            const avatars = {
              Minotaurs: { emoji: '🐂', class: 'minotaur-avatar', name: 'Taureau Enragé' },
              Krakens: { emoji: '🐙', class: 'kraken-avatar', name: 'Kraken des Profondeurs' },
              Phoenix: { emoji: '🔥', class: 'phoenix-avatar', name: 'Phoenix Éternel' },
              Werewolves: { emoji: '🐺', class: 'werewolf-avatar', name: 'Loup-Garou' }
            };
            return avatars[franchise] || { emoji: '⚡', class: 'franchise-avatar', name: 'Guerrier' };
          };

          // Actions positives et négatives
          const positiveActions = [
            { label: 'Hardworker', points: 6 },
            { label: 'Victoire le weekend', points: 4 },
            { label: 'Participation le weekend', points: 2 },
            { label: 'Entrainement/atelier facultatif', points: 4 },
            { label: 'Observation positive', points: 5 },
            { label: 'Bonus', points: 2 },
            { label: 'Bonus', points: 3 },
            { label: 'Bonus', points: 5 },
            { label: 'Bonus', points: 10 },
            { label: 'Félicitations', points: 25 },
            { label: 'Compliments', points: 15 },
            { label: 'Encouragements', points: 10 }
          ];

          const negativeActions = [
            { label: 'Observation négative', points: -5 },
            { label: 'Exclusion de cours', points: -8 },
            { label: 'Exclusion temporaire de l\'établissement', points: -15 },
            { label: 'Travail non fait', points: -3 },
            { label: 'Retard/absence non justifiée', points: -3 },
            { label: 'Absence non justifiée au club', points: -3 },
            { label: 'Pénalité', points: -2 },
            { label: 'Pénalité', points: -3 },
            { label: 'Pénalité', points: -5 }
          ];

          // Couleurs des franchises
          const franchiseColors = {
            Minotaurs: 'from-red-600 to-red-800',
            Krakens: 'from-blue-600 to-blue-800',
            Phoenix: 'from-orange-600 to-orange-800',
            Werewolves: 'from-green-600 to-green-800'
          };

          // Vérifier le mot de passe professeur (SIMULÉ)
          const verifyTeacher = async () => {
            if (!password.trim()) {
              setLoginError('Veuillez entrer un mot de passe');
              return;
            }
            
            // Simulation de vérification (accepte "admin" pour les tests)
            if (password === 'admin') {
              setUserType('teacher');
              setCurrentView('teacher-dashboard');
              setLoginError('');
            } else {
              setLoginError('Mot de passe incorrect');
            }
          };

          // Charger les joueurs depuis localStorage
          const loadPlayers = async () => {
            try {
              const savedPlayers = localStorage.getItem('players');
              if (savedPlayers) {
                setPlayers(JSON.parse(savedPlayers));
              }
            } catch (error) {
              console.error('Erreur lors du chargement des joueurs:', error);
            }
          };

          // Sauvegarder les
